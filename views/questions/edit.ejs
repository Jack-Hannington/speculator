
  <%- include('../partials/header') %>
  <%- include('../partials/nav') %>

  <% if (message && message.length > 0) { %>
    <div class="flash-messages-container animate__animated">
      <div class="flash-message">
        <iconify-icon icon="solar:info-circle-outline" inline class="brand-orange"></iconify-icon><%= message %>
      </div>
    </div>
  <% } %>

  <div class="container-xxl px-xl-4 px-0">
    <section>
      <div class="row">
      <div class="col-lg-9 col-12">
        <h1>Edit question</h1>
      </div>
    </div>
    </section>
  <form action="/questions/edit/<%= question.id %>" method="POST">
    <div class="form-row row mb-3">
      <div class="col-lg-3 col-12">
        <label class="form-label" for="category">Category:</label>
      </div>
      <div class="col-lg-9 col-12">
        <select class="form-select" id="category" name="category_id" required>
          <% categories.forEach(category => { %>
            <option value="<%= category.id %>" <%= category.id === question.category_id ? 'selected' : '' %>><%= category.name %></option>
          <% }) %>
        </select>
      </div>
    </div>

    <div class="form-row row mb-3">
      <div class="col-lg-3 col-12">
        <label class="form-label" for="question">Question:</label>
      </div>
      <div class="col-lg-9 col-12">
        <input type="text" class="form-control" id="question" name="question" value="<%= question.question %>" required>
      </div>
    </div>

    <div class="form-row row mb-3">
      <div class="col-lg-3 col-12">
        <label class="form-label" for="question_type">Question Type:</label>
      </div>
      <div class="col-lg-9 col-12">
        <input type="text" class="form-control" id="question_type" name="question_type" value="<%= question.question_type %>" required>
      </div>
    </div>

    <div class="form-row row mb-3">
      <div class="col-lg-3 col-12">
        <label class="form-label" for="detail">Detail:</label>
      </div>
      <div class="col-lg-9 col-12">
        <input type="text" class="form-control" id="detail" name="detail" value="<%= question.detail %>">
      </div>
    </div>

    <button type="submit" class="btn btn-primary">Save</button>
  </form>
  <section class="mt-3 mb-3">
    <div class="row">
    <div class="col-lg-9 col-12">
      <h2>Scoring rules</h2>
    </div>
    <div class="col-lg-3 col-12 d-flex justify-content-lg-end mt-lg-0 mt-2">
      <a class="btn "  href="/questions/<%= question.id %>/scoring_rules/create">Add scoring rule</a>
    </div>
  </div>
  </section>
  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th>Gender</th>
          <th>Age Range</th>
          <th>Min Value</th>
          <th>Max Value</th>
          <th>Score</th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <% scoringRules.forEach(rule => { %>
          <tr>
            <td><%= rule.gender %></td>
            <td><%= rule.min_age %> - <%= rule.max_age %></td>

            <td><%= rule.min_value %></td>
            <td><%= rule.max_value %></td>
            <td><%= rule.score %></td>
            <td class="text-end">
              <a href="/questions/scoring_rules/edit/<%= rule.id %>">Edit</a>
              <form action="/questions/scoring_rules/delete/<%= rule.id %>" method="POST" style="display:inline;" onsubmit="return confirmDelete();">
                <button type="submit" class="ms-2 btn btn-danger">Delete</button>
              </form>
            </td>
          </tr>
        <% }) %>
      </tbody>
    </table>
  </div>
</div>
<script>
  function confirmDelete() {
    return confirm("Are you sure you want to delete? Once deleted this rule cannot be retrieved.");
  }
</script>
  <%- include('../partials/footer') %>
